<!DOCTYPE html>
<html dir="ltr" lang="en-US">
  <head>
  	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  	<title>Documentation | Puppet Labs - Troubleshooting</title>
  	<meta name="description" content="The open source leader in data center automation">
  	<link rel="alternate" type="text/xml" title="Puppet Labs RSS 0.92 Feed" href="http://puppetlabs.com/feed/rss/">
  	<link rel="alternate" type="application/atom+xml" title="Puppet Labs Atom Feed" href="http://puppetlabs.com/feed/atom/">
  	<link rel="alternate" type="application/rss+xml" title="Puppet Labs RSS 2.0 Feed" href="http://puppetlabs.com/feed/">
  	<link rel="pingback" href="http://puppetlabs.com/xmlrpc.php">
    <link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://puppetlabs.com/xmlrpc.php?rsd" />
    <link rel='index' title='Puppet Labs' href='http://docs.puppetlabs.com' />

<!-- Google stats -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-1537572-5");
pageTracker._setDomainName(".puppetlabs.com");
pageTracker._trackPageview();
} catch(err) {}</script>
<!-- End Google stats -->


    <!-- FIXME: absolute paths -->

    <script type='text/javascript' src='/files/javascripts/html5.js'></script>
    <script type='text/javascript' src='/files/javascripts/jquery-1.3.2.min.js'></script>
    <script type='text/javascript' src='/files/javascripts/drop_down.js'></script>
    <script type='text/javascript' src='/files/javascripts/cufon-yui.js'></script>
    <script type='text/javascript' src='/files/fonts/Klavika_400-Klavika_600.font.js'></script>
    <script type='text/javascript' src='/files/javascripts/ampersands.js'></script>

    <!-- All in One SEO Pack 1.6.10.1 by Michael Torbert of Semper Fi Web Design[127,146] -->
    <meta name="keywords" content="Puppet, puppet labs, reductive labs, open source, system administrator, ruby, data center, automation, support" />
    <link rel="canonical" href="http://docs.puppetlabs.com" />
    <!-- /all in one seo pack -->
	
    <!-- FIXME: absolute paths -->

    <link rel="stylesheet" type="text/css" href="/files/stylesheets/style.css" media="screen"> <!-- index -->

    <!--[if IE 7]>
	  <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_7.css" media="screen"> <!-- index -->
    <![endif]-->
  
    <!--[if IE 8]>
	    <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_8.css" media="screen"> <!-- index -->
    <![endif]-->		

  	<script type="text/javascript">
      Cufon.replace('h1, h2', { fontWeight: '600' });
  	</script>
</head>



        
  <body id="resources" class="docs">
  <style type="text/css">h1, h2{ visibility : hidden }</style>		
  <!--[if IE 8]>
    <style type="text/css">h1, h2{ visibility : visible }</style>
  <![endif]-->		

  	<header id="header">
      <div class="site-width">
    		<h1><a href="http://puppetlabs.com/"><span>Puppet Labs</span></a></h1>
        <a class="screen-reader-content" href="#content">Skip navigation</a>
        <nav>
    		<ul id="global-navigation">
          <li id="puppet-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/puppet/">
              <span>Puppet</span>

              <span class="drop-down-trigger"></span>
            </a>
            <ul>            
              <li>
                <ul>
                  <li class="page_item page-item-757"><a href="http://www.puppetlabs.com/puppet/introduction/" title="Introduction">Introduction</a></li>
<li class="page_item page-item-769"><a href="http://www.puppetlabs.com/puppet/requirements/" title="Requirements">Requirements</a></li>
<li class="page_item page-item-956"><a href="http://www.puppetlabs.com/puppet/solutions/" title="Solutions">Solutions</a></li>
<li class="page_item page-item-1159"><a href="http://www.puppetlabs.com/puppet/users/" title="Users">Users</a></li>

<li class="page_item page-item-2415"><a href="http://www.puppetlabs.com/puppet/what-customers-are-saying/" title="What Customers are Saying">What Customers are Saying</a></li>
                </ul>
              </li>
              <li>
                <ul>
                  <li class="page_item page-item-1977"><a href="http://forge.puppetlabs.com" title="Module Forge">Module Forge</a></li>
<li class="page_item page-item-751"><a href="http://www.puppetlabs.com/puppet/related-projects/dashboard/" title="Dashboard">Dashboard</a></li>
<li class="page_item page-item-753"><a href="http://www.puppetlabs.com/puppet/related-projects/facter/" title="Facter">Facter</a></li>

                </ul>
              </li>
            </ul>
          </li>
          <li id="services-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/services/">
              <span>Services</span>
              <span class="drop-down-trigger"></span>

            </a>
            <ul>
              <li class="page_item page-item-783"><a href="http://www.puppetlabs.com/services/overview/" title="Overview">Overview</a></li>
<li class="page_item page-item-839"><a href="http://www.puppetlabs.com/services/support/" title="Enterprise Support">Enterprise Support</a></li>
<li class="page_item page-item-845"><a href="http://www.puppetlabs.com/services/training-workshops/" title="On-Site Training &amp; Consulting">On-Site Training &amp; Consulting</a></li>
<li class="page_item page-item-849"><a href="/category/events/upcoming/" title="Events &amp; Public Training">Events &amp; Public Training</a></li>

<li class="page_item page-item-2424"><a href="http://www.puppetlabs.com/services/what-customers-are-saying/" title="What Customers are Saying">What Customers are Saying</a></li>
<li class="page_item page-item-851"><a href="http://www.puppetlabs.com/services/partners/" title="Partners">Partners</a></li>
<li class="page_item page-item-1037"><a href="/resources/customer-support" title="Customer Support">Customer Support</a></li>
            </ul>
          </li>
          <li id="resources-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/resources/">
              <span>Resources</span>

              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-1048"><a href="http://www.puppetlabs.com/resources/overview-2/" title="Overview">Overview</a></li>
<li class="page_item page-item-833"><a href="http://www.puppetlabs.com/resources/case-studies/" title="Case Studies">Case Studies</a></li>
<li class="page_item page-item-1052"><a href="http://www.puppetlabs.com/resources/customer-support/" title="Customer Support">Customer Support</a></li>
<li class="page_item page-item-1040"><a href="http://docs.puppetlabs.com" title="Documentation">Documentation</a></li>
<li class="page_item page-item-872"><a href="http://info.puppetlabs.com/register-download" title="Downloads">Downloads</a></li>

<li class="page_item page-item-1961"><a href="http://forge.puppetlabs.com" title="Module Forge">Module Forge</a></li>
<li class="page_item page-item-835"><a href="http://info.puppetlabs.com/request-whitepapers.html" title="White Papers">White Papers</a></li>
<li class="page_item page-item-1967"><a href="http://projects.puppetlabs.com/projects/puppet/wiki" title="Wiki">Wiki</a></li>
            </ul>

          </li>
          <li id="community-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/community/">
              <span>Community</span>

              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-2195"><a href="http://www.puppetlabs.com/community/overview/" title="Overview">Overview</a></li>
<li class="page_item page-item-2264"><a href="http://www.puppetlabs.com/community/puppet-camp/" title="Puppet Camp">Puppet Camp</a></li>
<li class="page_item page-item-2249"><a href="http://www.puppetlabs.com/community/user-groups-and-devops-groups/" title="User Groups &amp; DevOps Groups">User Groups &amp; DevOps Groups</a></li>
<li class="page_item page-item-2215"><a href="http://www.puppetlabs.com/community/presentations/" title="Presentations">Presentations</a></li>

<li class="page_item page-item-2217"><a href="http://www.puppetlabs.com/community/videos/" title="Videos">Videos</a></li>
            </ul>
          </li>

          <li id="company-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/company/">
              <span>Company</span>
              <span class="drop-down-trigger"></span>
            </a>

            <ul>
              <li class="page_item page-item-2316"><a href="http://www.puppetlabs.com/company/overview/" title="Overview">Overview</a></li>
<li class="page_item page-item-2179"><a href="http://www.puppetlabs.com/company/news/" title="News">News</a></li>
<li class="page_item page-item-1571"><a href="http://www.puppetlabs.com/company/jobs/" title="Jobs">Jobs</a></li>
<li class="page_item page-item-2313"><a href="http://www.puppetlabs.com/company/contact-us/" title="Contact Us">Contact Us</a></li>
            </ul>
          </li>
    		</ul>	   
          <div id="misc-navigation">

			  <ul>
				<li><a href="http://docs.puppetlabs.com">Documentation</a></li>
				<li><a href="http://puppetlabs.com/resources/customer-support/">Support</a></li>
				<li><a href="http://puppetlabs.com/company/#contact">Contact Us</a></li>
				<li><a href="http://projects.puppetlabs.com/">Bug Tracker</a></li>
				<li><a href="http://puppetlabs.com/resources/downloads" class="gateway">Download</a></li>
			  </ul>
			<form action="http://www.google.com/cse" id="cse-search-box">

			  <div>
				<input type="hidden" name="cx" value="017884045025332504017:1mnj-dlgfcc" />
				<input type="hidden" name="ie" value="UTF-8" />
				<input type="text" name="q" size="31" />
				<input type="submit" name="sa" class="searchbtn" value="Search" />
			  </div>
			</form>
			<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en"></script>

          </div>
      </nav>
    	</div>
    </header>  

      <section id="masthead">
        <div class="site-width">
          <h1>Docs: <span class="section-name">Troubleshooting</span></h1>
          <ul id="doc-navigation">
            <li><a href="/">Docs Home</a></li>
            <li class="with-submenu">
              <a href="#">
                <span>Quick Nav</span>
                <span class="drop-down-trigger"></span>
              </a>
               <!-- the following links can't be relative, unfortunately -->
               <!-- future: add some JS to disable this if running from file:// -->
	            <dl>
	              <dt>Guides</dt>
	              <dd><a href="/index.html">Index</a></dd>
                      <dt>Resource Types</dt>
	              <dd><a href="/guides/types/">By Category</a></dd>
	              <dd><a href="/guides/types/alphabetical_index.html">Alphabetical</a></dd>
	              <dt>References</dt>
                      <dd><a href="/references/2.6.1/">2.6.1</a></dd>
                      <dd><a href="/references/2.6.0/">2.6.0</a></dd> 
                      <dd><a href="/references/0.25.5/">0.25.5</a></dd> 
	              <dd><a href="/references/0.24.8/">0.24.8</a></dd>
	              <dd><a href="/references/">Other Versions</a></dd>
	            </dl>
            </li>
            <li><a href="/contribute.html">Contribute</a></li>
          </ul>
        </div>
      </section>
    
      <section id="content">
        <div class="site-width">
          <div class="primary-secondary-content">
            <div class="primary-content">
              <h1 id='troubleshooting'>Troubleshooting</h1>

<p>Answers to some common problems that may come up.</p>

<p>Basic workflow items are covered in the main section of the documentation. If you&#8217;re looking for how to do something unconventional, you may also wish to read <a href='./techniques.html'>Techniques</a>.</p>
              <h2 id='why_hasnt_my_new_node_configuration_been_noticed'>Why hasn&#8217;t my new node configuration been noticed?</h2>

<p>If you&#8217;re using separate node definition files and import them into site.pp with an import *.node (for example) you&#8217;ll find that new files added won&#8217;t get noticed until you restart puppetmasterd. This is due to the fact globs aren&#8217;t evaluated on each run, but only when the &#8216;parent&#8217; file is re-read.</p>

<p>To make sure your new file is actually read, simply &#8216;touch&#8217; the site.pp (or importing file) and the glob will be re-evaluated.</p>

<h2 id='why_dont_my_certificates_show_as_waiting_to_be_signed_on_my_server_when_i_do_a_puppetca_list'>Why don&#8217;t my certificates show as waiting to be signed on my server when I do a &#8220;puppetca &#8211;list&#8221;?</h2>

<p>puppetca must be run as root. If you are not root then rerun the command with sudo:</p>

<pre><code>sudo puppetca --list</code></pre>

<h2 id='i_keep_getting_certificates_were_not_trusted_whats_wrong'>I keep getting &#8220;certificates were not trusted&#8221;. What&#8217;s wrong?</h2>

<p>Firstly, if you&#8217;re re-installing a machine, you probably haven&#8217;t cleared the previous certificate for that machine. To correct the problem:</p>

<pre><code>1.  Run &quot;sudo puppetca --clean \$fqdn&quot; on the Puppetmaster to
    clear the certificates.
2.  Remove the entire SSL directory of the client machine:

&gt; rm -r etc/puppet/ssl rm -r /var/lib/puppet/ssl</code></pre>

<p>Assuming that you&#8217;re not re-installing, by far the most common cause of SSL problems is that the clock on the client machine is set incorrectly, which confuses SSL because the &#8220;validFrom&#8221; date in the certificate is in the future.</p>

<p>You can figure the problem out by manually verifying the certificate with openssl:</p>

<pre><code>sudo openssl verify -CAfile /etc/puppet/ssl/certs/ca.pem /etc/puppet/ssl/certs/myhostname.domain.com.pem</code></pre>

<p>This can also happen if you&#8217;ve followed the <span><span>Using Mongrel</span></span> pattern to alleviate file download problems. If your set-up is such that the host name differs from the name in the Puppet server certificate, or there is any other SSL certificate negotiation problem, the SSL handshake between client and server will fail. In this case, either alleviate the SSL handshake problems (debug using cURL), or revert to the original Webrick installation.</p>

<h2 id='im_getting_ipv6_errors_whats_wrong'>I&#8217;m getting IPv6 errors; what&#8217;s wrong?</h2>

<p>This can apparently happen if Ruby is not compiled with IPv6 support; see the mail thread for more details. The only known solution is to make sure you&#8217;re running a version of Ruby compiled with IPv6 support.</p>

<h2 id='im_getting_tlsv1_alert_unknown_ca_errors_whats_wrong'>I&#8217;m getting tlsv1 alert unknown ca errors; what&#8217;s wrong?</h2>

<p>This problem is caused by puppetmasterd not being able to read its ca certificate. This problem might occur up to 0.18.4 but has been fixed in 0.19.0. You can probably fix it for versions before 0.19.0 by changing the group ownership of the /etc/puppet/ssl directory to the puppet group, but puppetd may change the group back. Having puppetmasterd start as the root user should fix the problem permanently until you can upgrade.</p>

<h2 id='why_does_puppet_keep_trying_to_start_a_running_service'>Why does Puppet keep trying to start a running service?</h2>

<p>The ideal way to check for a service is to use the hasstatus parameter, which calls the init script with the status parameter. This should report back to Puppet whether the service is running or stopped.</p>

<p>In some broken scripts, however, the status output will be correct (&#8220;Ok&#8221; or &#8220;not running&#8221;), but the exit code of the script will be incorrect. Most commonly, the script will always blindly return 0, no matter what the actual service state is. Puppet only uses the exit code, so interprets this as &#8220;the service is stopped&#8221;.</p>

<p>There are two workarounds, and one fix. If you must deal with the scripts broken behavior as is, you can modify your resource to either use the pattern parameter to look for a particular process name, or the status parameter to use a custom script to check for the service status.</p>

<p>The fix is to rewrite the init script to use the proper exit codes. When rewriting them, or submitting bug reports to vendors or upstream, be sure to reference the <a href='http://refspecs.linux-foundation.org/LSB_3.1.0/LSB-Core-generic/LSB-Core-generic/iniscrptact.html'>LSB Init Script Actions</a> standard. This should carry more weight by pointing out an official, published standard they&#8217;re failing to meet, rather than trying to explain how their bug is causing problems in Puppet.</p>

<h2 id='im_using_the_nagios_types_but_the_puppet_run_on_the_server_running_nagios_is_starting_to_take_ages'>I&#8217;m using the Nagios types but the Puppet run on the server running Nagios is starting to take ages</h2>

<p><strong>Note:</strong> This has heavily been improved with 0.25 and it&#8217;s not anymore a problem. The proposed workaround should be considered only on systems running puppet \&lt; 0.25</p>

<p>If you are exporting Nagios objects, they will need to be collected on your Nagios server to be added to the nagios service configuration file.</p>

<p>Let&#8217;s say you are exporting some hundreds of nagios_service objects, the corresponding nagios_service.cfg file will be quite large. On every puppet run however, for each and every nagios_service defined, puppet will have to seek through that file to see if anything has changed. This is incredibly time consuming.</p>

<p>You&#8217;ll have better results using the &#8220;target&#8221; option for the nagios_service tyepe, e.g.</p>

<pre><code>nagios_service { &quot;check_ssh_$fqdn&quot;:
     ensure =&gt; present,
     check_command =&gt; &quot;check_ssh&quot;,
     use =&gt; &quot;generic-service&quot;,
     host_name =&gt; $fqdn,
     service_description =&gt; &quot;SSH&quot;,
     target =&gt; &quot;/etc/nagios/nagios_service.d/check_ssh_$fqdn&quot;
}</code></pre>

<p>This will dramatically improve your puppet run performance, as puppet only has to look in the directory for the file it needs and seek through a file with only one service definition in it.</p>

<h2 id='why_is_my_external_node_configuration_failing__i_get_no_errors_by_running_the_script_by_hand'>Why is my external node configuration failing ? I get no errors by running the script by hand.</h2>

<p>Most of the time, if you get the following error when running you client</p>

<pre><code>warning: Not using cache on failed catalog
err: Could not retrieve catalog; skipping run</code></pre>

<p>it is because of some invalid YAML output from your external node script. Check <a href='http://www.yaml.org'>http://www.yaml.org</a> if you have doubts about validity.</p>

<h1 id='puppet_syntax_errors'>Puppet Syntax Errors</h1>

<p>Puppet generates syntax errors when manifests are incorrectly written. Sometimes these errors can be a little cryptic. Below is a list of common errors and their explanations that should help you trouble-shoot your manifests.</p>

<h2 id='syntax_error_at__expected__at_manifestppnnn'>Syntax error at &#8217;}&#8217;; expected &#8217;}&#8217; at manifest.pp:nnn</h2>

<p>This error can occur when:</p>

<pre><code>service { &quot;fred&quot; }</code></pre>

<p>This contrived example demonstrates one way to get the very confusing error of Puppet&#8217;s parser expecting what it found. In this example, the colon ( : ) is missing after the service title. A variant looks like:</p>

<pre><code>service { &quot;fred&quot;
    ensure =&gt; running
}</code></pre>

<p>and the error would be Syntax error at &#8216;ensure&#8217;; expected &#8217;}&#8217; .</p>

<p>You can also get the same error if you forget a comma. For instance, in this example the comma is missing at the end of line 3: service { &#8220;myservice&#8221;: provider =&gt; &#8220;runit&#8221; path =&gt; &#8220;/path/to/daemons&#8221; }</p>

<h2 id='syntax_error_at__expected__at_manifestppnnn'>Syntax error at &#8217;:&#8217;; expected &#8217;]&#8217; at manifest.pp:nnn</h2>

<p>This error can occur when:</p>

<pre><code>classname::define_name {
    &quot;jdbc/automation&quot;:
        cpoolid     =&gt; &quot;automationPool&quot;,
        require     =&gt; [ Classname::other_define_name[&quot;automationPool&quot;] ],
}</code></pre>

<p>The problem here is that Puppet requires that object references in the require lines to begin with a capital letter. However, since this is a reference to a class and a define, the define also needs to have a capital letter, so Classname::Other_define_name would be the correct syntax.</p>

<h2 id='syntax_error_at__expected__at_manifestppnnn'>Syntax error at &#8217;.&#8217;; expected &#8217;}&#8217; at manifest.pp:nnn</h2>

<p>This error happens when you use unquoted comparators with dots in them, a&#8217;la:</p>

<pre><code>class autofs {

  case $kernelversion {
    2.6.9:   { $autofs_packages = [&quot;autofs&quot;, &quot;autofs5&quot;] }
    default: { $autofs_packages = [&quot;autofs&quot;] }
  }
}</code></pre>

<p>That 2.6.9 needs to have doublequotes around it, like so:</p>

<pre><code>class autofs {

   case $kernelversion {
     &quot;2.6.9&quot;:   { $autofs_packages = [&quot;autofs&quot;, &quot;autofs5&quot;] }
     default: { $autofs_packages = [&quot;autofs&quot;] }
   }
 }</code></pre>

<h2 id='could_not_match__define_name_at_manifestppnnn_on_node_nodename'>Could not match &#8216;_define_name&#8217; at manifest.pp:nnn on node nodename</h2>

<p>This error can occur using a manifest like:</p>

<pre><code>case $ensure {
    &quot;present&quot;: {
        _define_name {
            &quot;$title&quot;:
                user        =&gt; $user,
        }
    }
}</code></pre>

<p>This one is simple - you cannot begin a function name (define name) with an underscore.</p>

<h2 id='duplicate_definition_classnamedefine_namesystem_is_already_defined_in_file_manifestpp_at_line_nnn_cannot_redefine_at_manifestppnnn_on_node_nodename'>Duplicate definition: Classname::Define_name<span>system</span> is already defined in file manifest.pp at line nnn; cannot redefine at manifest.pp:nnn on node nodename</h2>

<p>This error can occur when using a manifest like:</p>

<pre><code>Classname::define_name {
     &quot;system&quot;:
         properties  =&gt; &quot;Name=system&quot;;
     .....
     &quot;system&quot;:
          properties  =&gt; &quot;Name=system&quot;;
 }</code></pre>

<p>The most confusing part of this error is that the line numbers are usually the same - this is the case when using the block format that Puppet supports for a resource definition. In this contrived example, the system entry has been defined twice, so one of them needs removing.</p>

<h2 id='syntax_error_at__expected_'>Syntax error at &#8216;=&gt;&#8217;; expected &#8217;)&#8217;</h2>

<p>This error can occur when you use a manifest like:</p>

<pre><code>define foo($param =&gt; &#39;value&#39;) { ... }</code></pre>

<p>Default values for parameters are assigned, not defined, therefore a &#8217;=&#8217;, not a &#8216;=&gt;&#8217; operator is needed.</p>

<h2 id='err_exported_resource_blahsome_title_cannot_override_local_resource_on_node_nodename'>err: Exported resource Blah<span>$some_title</span> cannot override local resource on node $nodename</h2>

<p>While this is not a classic &#8220;syntax&#8221; error, it is a annoying error none-the-less. The actual error tells you that you have a local resource Blah<span>$some_title</span> that puppet refuses to overwrite with a collected resource of the same name. What most often happens, that the same resource is exported by two nodes. One of them is collected first and when trying to collect the second resource, this error happens as the first is already converted to a &#8220;local&#8221; resource.</p>

<h1 id='common_misconceptions'>Common Misconceptions</h1>

<h2 id='node_inheritance_and_variable_scope'>Node Inheritance and Variable Scope</h2>

<p>It is generally assumed that the following will result in the /tmp/puppet-test.variable file containing the string &#8216;my_node&#8217;:</p>

<pre><code>class test_class {
    file { &quot;/tmp/puppet-test.variable&quot;:
       content =&gt; &quot;$testname&quot;,
       ensure =&gt; present,
    }
}

node base_node {
    include test_class
}

node my_node inherits base_node {
    $testname = &#39;my_node&#39;
}</code></pre>

<p>Contrary to expectations, /tmp/puppet-test.variable is created with no contents. This is because the inherited test_class remains in the scope of base_node, where $testname is undefined.</p>

<p>Node inheritance is currently only really useful for inheriting static or self-contained classes, and is as a result of quite limited value.</p>

<p>A workaround is to define classes for your node types - essentially include classes rather than inheriting them. For example:</p>

<pre><code>class test_class {
    file { &quot;/tmp/puppet-test.variable&quot;:
       content =&gt; &quot;$testname&quot;,
       ensure =&gt; present,
    }
}

class base_node_class {
    include test_class
}

node my_node {
    $testname = &#39;my_node&#39;
    include base_node_class
}</code></pre>

<p>/tmp/puppet-test.variable will now contain &#8216;my_node&#8217; as desired.</p>

<h2 id='class_inheritance_and_variable_scope'>Class Inheritance and Variable Scope</h2>

<p>The following would also not work as generally expected:</p>

<pre><code>class base_class {
    $myvar = &#39;bob&#39;
    file {&quot;/tmp/testvar&quot;:
         content =&gt; &quot;$myvar&quot;,
         ensure =&gt; present,
    }
}

class child_class inherits base_class {
    $myvar = &#39;fred&#39;
}</code></pre>

<p>The /tmp/testvar file would be created with the content &#8216;bob&#8217;, as this is the value of $myvar where the type is defined.</p>

<p>A workaround would be to &#8216;include&#8217; the base_class, rather than inheriting it, and also to strip the $myvar out of the included class itself (otherwise it will cause a variable scope conflict - $myvar would be set twice in the same child_class scope):</p>

<pre><code>$myvar = &#39;bob&#39;

class base_class {
    file {&quot;/tmp/testvar&quot;:
         content =&gt; &quot;$myvar&quot;,
         ensure =&gt; present,
    }
}

class child_class {
    $myvar = &#39;fred&#39;
    include base_class
}</code></pre>

<p>In some cases you can reset the content of the file resource so that the scope used for the content (e.g., template) is rebound. Example:</p>

<pre><code>class base_class {
    $myvar = &#39;bob&#39;
    file { &quot;/tmp/testvar&quot;:
         content =&gt; template(&quot;john.erb&quot;),
    }
}

class child_class inherits base_class {
    $myvar = &#39;fred&#39;
    File[&quot;/tmp/testvar&quot;] { content =&gt; template(&quot;john.erb&quot;) }
}</code></pre>

<p>(john.erb contains a reference like \&lt;%= myvar %&gt;.)</p>

<p>To avoid the duplication of the template filename, it is better to sidestep the problem altogether with a define:</p>

<pre><code>class base_class {
    define testvar_file($myvar=&quot;bob&quot;) {
         file { $name:
             content =&gt; template(&quot;john.erb&quot;),
         }
    }
    testvar_file { &quot;/tmp/testvar&quot;: }
}

class child_class inherits base_class {
    Base_class::Testvar_file[&quot;/tmp/testvar&quot;] { myvar =&gt; fred }
}</code></pre>

<p>Whilst not directly solving the problem also useful are qualified variables that allow you to refer to and assign variables from other classes. Qualified variables might provoke alternate methods of solving this issue. You can use qualified methods like:</p>

<pre><code>class foo {
    $foovariable = &quot;foobar&quot;
}

class bar {
    $barvariable = $foo::foovariable
}</code></pre>

<p>In this example the value of the of the $barvariable variable in the bar class will be set to foobar the value of the $foovariable variable which was set in the foo class.</p>

<h1 id='custom_type__provider_development'>Custom Type &amp; Provider development</h1>

<h2 id='err_could_not_retrieve_catalog_invalid_parameter_foo_for_type_bar'>err: Could not retrieve catalog: Invalid parameter &#8216;foo&#8217; for type &#8216;bar&#8217;</h2>

<p>When you are developing new custom types, you should restart both the puppetmasterd and the puppetd before running the configuration using the new custom type. The pluginsync feature will then synchronise the files and the new code will be loaded when both daemons are restarted.</p>
            </div>
            <div class="secondary-content">
                    <div id="subCol">
        <h3 class="chapter">Contents</h3>
        <ol class="chapters">
<li>
<a href="#troubleshooting">Troubleshooting</a><ul style="list-style: none;">
<li><a href="#why_hasnt_my_new_node_configuration_been_noticed">Why hasn’t my new node configuration been noticed?</a></li>
<li><a href="#why_dont_my_certificates_show_as_waiting_to_be_signed_on_my_server_when_i_do_a_puppetca_list">Why don’t my certificates show as waiting to be signed on my server when I do a “puppetca –list”?</a></li>
<li><a href="#i_keep_getting_certificates_were_not_trusted_whats_wrong">I keep getting “certificates were not trusted”. What’s wrong?</a></li>
<li><a href="#im_getting_ipv6_errors_whats_wrong">I’m getting IPv6 errors; what’s wrong?</a></li>
<li><a href="#im_getting_tlsv1_alert_unknown_ca_errors_whats_wrong">I’m getting tlsv1 alert unknown ca errors; what’s wrong?</a></li>
<li><a href="#why_does_puppet_keep_trying_to_start_a_running_service">Why does Puppet keep trying to start a running service?</a></li>
<li><a href="#im_using_the_nagios_types_but_the_puppet_run_on_the_server_running_nagios_is_starting_to_take_ages">I’m using the Nagios types but the Puppet run on the server running Nagios is starting to take ages</a></li>
<li><a href="#why_is_my_external_node_configuration_failing__i_get_no_errors_by_running_the_script_by_hand">Why is my external node configuration failing ? I get no errors by running the script by hand.</a></li>
</ul>
</li>
<li>
<a href="#puppet_syntax_errors">Puppet Syntax Errors</a><ul style="list-style: none;">
<li><a href="#syntax_error_at__expected__at_manifestppnnn">Syntax error at ’}’; expected ’}’ at manifest.pp:nnn</a></li>
<li><a href="#syntax_error_at__expected__at_manifestppnnn">Syntax error at ’:’; expected ’]’ at manifest.pp:nnn</a></li>
<li><a href="#syntax_error_at__expected__at_manifestppnnn">Syntax error at ’.’; expected ’}’ at manifest.pp:nnn</a></li>
<li><a href="#could_not_match__define_name_at_manifestppnnn_on_node_nodename">Could not match ‘_define_name’ at manifest.pp:nnn on node nodename</a></li>
<li><a href="#duplicate_definition_classnamedefine_namesystem_is_already_defined_in_file_manifestpp_at_line_nnn_cannot_redefine_at_manifestppnnn_on_node_nodename">Duplicate definition: Classname::Define_name<span>system</span> is already defined in file manifest.pp at line nnn; cannot redefine at manifest.pp:nnn on node nodename</a></li>
<li><a href="#syntax_error_at__expected_">Syntax error at ‘=&gt;’; expected ’)’</a></li>
<li><a href="#err_exported_resource_blahsome_title_cannot_override_local_resource_on_node_nodename">err: Exported resource Blah<span>$some_title</span> cannot override local resource on node $nodename</a></li>
</ul>
</li>
<li>
<a href="#common_misconceptions">Common Misconceptions</a><ul style="list-style: none;">
<li><a href="#node_inheritance_and_variable_scope">Node Inheritance and Variable Scope</a></li>
<li><a href="#class_inheritance_and_variable_scope">Class Inheritance and Variable Scope</a></li>
</ul>
</li>
<li>
<a href="#custom_type__provider_development">Custom Type &amp; Provider development</a><ul style="list-style: none;"><li><a href="#err_could_not_retrieve_catalog_invalid_parameter_foo_for_type_bar">err: Could not retrieve catalog: Invalid parameter ‘foo’ for type ‘bar’</a></li></ul>
</li></ol></div>
            </div>
          </div>
        </div>
      </section>

		<footer id="footer">
      <div class="site-width">
        <div class="primary-secondary-content">
          <div class="primary-content">
            <section id="newsletter">
                 <h4>Puppet Labs is Hiring</h4>
                 <p><a href="http://www.puppetlabs.com/company/jobs/">Engineers, developers & consultants</a>
                  <p>  
		<h4>Newsletter</h4>
              <p>Stay up to date on all things puppet</p>
              <form action="http://lfov.net/webrecorder/f" method="post" name="Newsletter" id="footerform">
                <input type="hidden" name="formid" value="3d424fd0-4204-435f-afde-aa1c4a6bc2f1"/>
                <input type="hidden" name="cid" value="LF_c268993e"/>
                <fieldset>
                  <legend>Newsletter</legend>
                  <label form="email">Email</label>
                  <input type="text" name="email" id="email" class="required email" />
                  <button type="submit">Subscribe</button>
                </fieldset>
              </form>

            </section>
            <section id="elsewhere">
              <h4>Get Involved</h4>
              <ul>
                <li class="chat"><a href="http://webchat.freenode.net/?channels=puppet" rel="external"><span class="indicator"></span><span>Chat with us on IRC</span></a></li>
                <li class="discussion"><a href="http://groups.google.com/group/puppet-users?pli=1" rel="external"><span class="indicator"></span><span>Join the Mailing List</span></a></li>
                
                <li class="linkedin"><a href="http://www.linkedin.com/groups?about=&gid=696467&trk=anet_ug_grppro" rel="external"><span class="indicator"></span><span>Join the Puppet Users LinkedIn group</span></a></li>

		

              </ul>
            </section>
          </div>
          <div class="secondary-content">
            <section id="book-it">
              <h4>Get the book!</h4>
              <p>Written by James Turnbull, <a href="http://apress.com/book/view/1590599780" rel="nofollow">Pulling Strings with Puppet</a> is the first book to introduce the powerful Puppet system administration tool. </p>
              <a href="http://apress.com/book/view/1590599780" rel="nofollow"><img src="http://puppetlabs.com/images/book.png" /></a>
            </section>
          </div>
        </div>
      </div>
		</footer>

    <div id="copyright">
      <div class="site-width">
        &copy; <?= date('Y'); ?> <a href="<?php bloginfo('url'); ?>/" title="<?php bloginfo('name'); ?>"><?php bloginfo('name'); ?></a>
        <span class="vcard">
         <span class="org"></span>
         <a class="email" href="mailto:info@puppetlabs.com">info@puppetlabs.com</a>
          <span class="adr">
           <span class="street-address">222 NW Davis Street</span>
           /
           <span class="locality">Portland</span>, 
           <span class="region">OR</span>
           <span class="postal-code">97209</span>

          </span>
         <span class="tel">1-877-575-9775</span>
        </span>          
      </div>
    </div>
    <script src="http://munchkin.marketo.net/munchkin.js" type="text/javascript"></script> <script>mktoMunchkin("307-QLA-991");</script> 
    <!-- BEGIN: LOOPFUSE TRACKING -->
    <script src="http://lfov.net/webrecorder/js/listen.js" type="text/Javascript"></script>
    <script type="text/Javascript">
    _lf_cid = "LF_c268993e";
    _lf_remora();
    </script>
    <!-- END: LOOPFUSE TRACKING -->
    
  	<script type="text/javascript">Cufon.now();</script>
  	<style type="text/css">h1, h2, .btn { visibility : visible; }</style>

	</body>
</html>        
