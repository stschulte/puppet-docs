<!DOCTYPE html>
<html dir="ltr" lang="en-US">
  <head>
  	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  	<title>Documentation | Puppet Labs - REST API</title>
  	<meta name="description" content="The open source leader in data center automation">
  	<link rel="alternate" type="text/xml" title="Puppet Labs RSS 0.92 Feed" href="http://puppetlabs.com/feed/rss/">
  	<link rel="alternate" type="application/atom+xml" title="Puppet Labs Atom Feed" href="http://puppetlabs.com/feed/atom/">
  	<link rel="alternate" type="application/rss+xml" title="Puppet Labs RSS 2.0 Feed" href="http://puppetlabs.com/feed/">
  	<link rel="pingback" href="http://puppetlabs.com/xmlrpc.php">
    <link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://puppetlabs.com/xmlrpc.php?rsd" />
    <link rel='index' title='Puppet Labs' href='http://docs.puppetlabs.com' />

<!-- Google stats -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-1537572-5");
pageTracker._setDomainName(".puppetlabs.com");
pageTracker._trackPageview();
} catch(err) {}</script>
<!-- End Google stats -->


    <!-- FIXME: absolute paths -->

    <script type='text/javascript' src='/files/javascripts/html5.js'></script>
    <script type='text/javascript' src='/files/javascripts/jquery-1.3.2.min.js'></script>
    <script type='text/javascript' src='/files/javascripts/drop_down.js'></script>
    <script type='text/javascript' src='/files/javascripts/cufon-yui.js'></script>
    <script type='text/javascript' src='/files/fonts/Klavika_400-Klavika_600.font.js'></script>
    <script type='text/javascript' src='/files/javascripts/ampersands.js'></script>

    <!-- All in One SEO Pack 1.6.10.1 by Michael Torbert of Semper Fi Web Design[127,146] -->
    <meta name="keywords" content="Puppet, puppet labs, reductive labs, open source, system administrator, ruby, data center, automation, support" />
    <link rel="canonical" href="http://docs.puppetlabs.com" />
    <!-- /all in one seo pack -->
	
    <!-- FIXME: absolute paths -->

    <link rel="stylesheet" type="text/css" href="/files/stylesheets/style.css" media="screen"> <!-- index -->

    <!--[if IE 7]>
	  <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_7.css" media="screen"> <!-- index -->
    <![endif]-->
  
    <!--[if IE 8]>
	    <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_8.css" media="screen"> <!-- index -->
    <![endif]-->		

  	<script type="text/javascript">
      Cufon.replace('h1, h2', { fontWeight: '600' });
  	</script>
</head>



        
  <body id="resources" class="docs">
  <style type="text/css">h1, h2{ visibility : hidden }</style>		
  <!--[if IE 8]>
    <style type="text/css">h1, h2{ visibility : visible }</style>
  <![endif]-->		

  	<header id="header">
      <div class="site-width">
    		<h1><a href="http://puppetlabs.com/"><span>Puppet Labs</span></a></h1>
        <a class="screen-reader-content" href="#content">Skip navigation</a>
        <nav>
      		<ul id="global-navigation">
            <li id="puppet-tab" class="with-submenu">

              <a href="http://puppetlabs.com/puppet/">
                <span>Puppet</span>
                <span class="drop-down-trigger"></span>
              </a>
              <ul>            
                <li>
                  <ul>
                    <li class="page_item page-item-757"><a href="http://puppetlabs.com/puppet/introduction/" title="Introduction">Introduction</a></li>
                    <li class="page_item page-item-769"><a href="http://puppetlabs.com/puppet/requirements/" title="Requirements">Requirements</a></li>
                    <li class="page_item page-item-828"><a href="http://puppetlabs.com/puppet/features/" title="Features">Features</a></li>
                    <li class="page_item page-item-956"><a href="http://puppetlabs.com/puppet/solutions/" title="Solutions">Solutions</a></li>
                    <li class="page_item page-item-1159"><a href="http://puppetlabs.com/puppet/users/" title="Users">Users</a></li>
                    <li class="page_item page-item-1074"><a href="http://puppetlabs.com/resources/white-papers" title="White Papers">White Papers</a></li>
                    <li class="page_item page-item-1495"><a href="http://puppetlabs.com/resources/case-studies" title="Case Studies">Case Studies</a></li>
                    <li class="page_item page-item-1044"><a href="http://puppetlabs.com/resources/downloads" title="Downloads">Downloads</a></li>
                  </ul>
                </li>
                <li>
                  <ul>
                    <li class="page_item page-item-751"><a href="http://puppetlabs.com/puppet/related-projects/dashboard/" title="Dashboard">Dashboard</a></li>
                    <li class="page_item page-item-753"><a href="http://puppetlabs.com/puppet/related-projects/facter/" title="Facter">Facter</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li id="services-tab" class="with-submenu">
              <a href="http://puppetlabs.com/services/">
                <span>Services</span>
                <span class="drop-down-trigger"></span>
              </a>
              <ul>
                <li class="page_item page-item-783"><a href="http://puppetlabs.com/services/overview/" title="Overview">Overview</a></li>
                <li class="page_item page-item-839"><a href="http://puppetlabs.com/services/support/" title="Enterprise Support">Enterprise Support</a></li>
                <li class="page_item page-item-845"><a href="http://puppetlabs.com/services/training-workshops/" title="On-Site Training &amp; Consulting">On-Site Training &amp; Consulting</a></li>
                <li class="page_item page-item-849"><a href="http://puppetlabs.com/category/events/upcoming/" title="Events &amp; Public Training">Events &amp; Public Training</a></li>
                <li class="page_item page-item-851"><a href="http://puppetlabs.com/services/partners/" title="Partners">Partners</a></li>
                <li class="page_item page-item-1037"><a href="http://puppetlabs.com/resources/customer-support" title="Customer Support">Customer Support</a></li>
              </ul>
            </li>
            <li id="resources-tab" class="with-submenu">
              <a href="http://puppetlabs.com/resources/">
                <span>Resources</span>
                <span class="drop-down-trigger"></span>
              </a>
              <ul>
                <li class="page_item page-item-1048"><a href="http://puppetlabs.com/resources/overview-2/" title="Overview">Overview</a></li>
                <li class="page_item page-item-1040"><a href="http://docs.puppetlabs.com" title="Documentation">Documentation</a></li>
                <li class="page_item page-item-872"><a href="http://puppetlabs.com/resources/downloads/" title="Downloads">Downloads</a></li>
                <li class="page_item page-item-835"><a href="http://puppetlabs.com/resources/white-papers/" title="White Papers">White Papers</a></li>
                <li class="page_item page-item-833"><a href="http://puppetlabs.com/resources/case-studies/" title="Case Studies">Case Studies</a></li>
                <li class="page_item page-item-1052"><a href="http://puppetlabs.com/resources/customer-support/" title="Customer Support">Customer Support</a></li>
              </ul>

            </li>
            <li id="community-tab">
              <a href="http://puppetlabs.com/community/">
                <span>Community</span>
              </a>
            </li>

            <li id="company-tab" class="with-submenu">
              <a href="http://puppetlabs.com/company/">
                <span>Company</span>
                <span class="drop-down-trigger"></span>
              </a>
              <ul>
                <li><a href="http://puppetlabs.com/company/">About Us</a></li>
                <li><a href="http://puppetlabs.com/company/#contact">Contact Us</a></li>
              </ul>
            </li>
      		</ul>	   
          <div id="misc-navigation">
			<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en"></script>
			  <ul>
				<li><a href="http://docs.puppetlabs.com">Documentation</a></li>
				<li><a href="http://puppetlabs.com/resources/customer-support/">Support</a></li>
				<li><a href="http://puppetlabs.com/company/#contact">Contact Us</a></li>
				<li><a href="http://puppetlabs.com/resources/downloads" class="gateway">Download</a></li>
			  </ul>
			<form action="http://www.google.com/cse" id="cse-search-box">
			  <div>
				<input type="hidden" name="cx" value="017884045025332504017:1mnj-dlgfcc" />
				<input type="hidden" name="ie" value="UTF-8" />
				<input type="text" name="q" size="31" />
				<input type="submit" name="sa" class="searchbtn" value="Search" />
			  </div>
			</form>
			<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en"></script>
		  </div>
        </nav>
    	</div>
    </header>  

      <section id="masthead">
        <div class="site-width">
          <h1>Docs: <span class="section-name">REST API</span></h1>
          <ul id="doc-navigation">
            <li><a href="/">Docs Home</a></li>
            <li class="with-submenu">
              <a href="#">
                <span>Quick Nav</span>
                <span class="drop-down-trigger"></span>
              </a>
               <!-- the following links can't be relative, unfortunately -->
               <!-- future: add some JS to disable this if running from file:// -->
	            <dl>
	              <dt>Guides</dt>
	              <dd><a href="/index.html">Index</a></dd>
                      <dt>Resource Types</dt>
	              <dd><a href="/guides/types/">By Category</a></dd>
	              <dd><a href="/guides/types/alphabetical_index.html">Alphabetical</a></dd>
	              <dt>References</dt>
                      <dd><a href="/references/2.6.1/">2.6.1</a></dd>
                      <dd><a href="/references/2.6.0/">2.6.0</a></dd> 
                      <dd><a href="/references/0.25.5/">0.25.5</a></dd> 
	              <dd><a href="/references/0.24.8/">0.24.8</a></dd>
	              <dd><a href="/references/">Other Versions</a></dd>
	            </dl>
            </li>
            <li><a href="/contribute.html">Contribute</a></li>
          </ul>
        </div>
      </section>
    
      <section id="content">
        <div class="site-width">
          <div class="primary-secondary-content">
            <div class="primary-content">
              <h1 id='rest_api'>REST API</h1>

<p>Both puppet master and puppet agent have RESTful API&#8217;s that they use to communicate. The basic structure of the url to access this API is</p>

<pre><code>https://yourpuppetmaster:8140/{environment}/{resource}/{key}
https://yourpuppetclient:8139/{environment}/{resource}/{key}</code></pre>

<p>Details about what resources are available and the formats they return are below.</p>
              <h1 id='rest_api_security'>REST API Security</h1>

<p>Puppet usually takes care of <a href='./security.html'>security</a> and SSL certificate management for you, but if you want to use the RESTful API outside of that you&#8217;ll need to manage certificates yourself when you connect. The easiest way to do this is to have puppet agent already authorized with a certificate that has been signed by the puppet master and use that certificate to connect, or for testing to set the security policy so that any request from anywhere is allowed.</p>

<p>The security policy for the API can be controlled through the <a href='./security.html#authconf'>rest_authconfig</a> file, and specifically for the nodes running puppet agent through the <a href='./security.html#namespaceauthconf'>namespaceauth</a> file.</p>

<h1 id='testing_the_rest_api_using_curl'>Testing the REST API using curl</h1>

<p>An example of how you can use the REST API to retrieve the catalog for a node can be seen using <a href='http://en.wikipedia.org/wiki/CURL'>curl</a>.</p>

<pre><code>curl --cert /etc/puppet/ssl/certs/mymachine.pem --key /etc/puppet/ssl/private_keys/mymachine.pem --cacert /etc/puppet/ssl/ca/ca_crt.pem -H &#39;Accept: yaml&#39; https://puppetmaster:8140/production/catalog/mymachine</code></pre>

<p>Most of this command is just setting the appropriate ssl certificates, which will be different depending on where your ssldir is and your node name. For simplicity, lets look at this command without the certificate related options, which I&#8217;ll assume you&#8217;re either passing in as above or changing the <a href='./security.html'>security policy</a> so that you don&#8217;t need to be authenticated. If you are changing the security policy curl will want a -k or &#8211;insecure option to connect to an https address without certificates.</p>

<pre><code>curl --insecure -H &#39;Accept: yaml&#39; https://puppetmaster:8140/production/catalog/mymachine</code></pre>

<p>Basically we just send a header specifying the format or formats we want back, and the RESTful URI for getting a catalog for mymachine in the production environment. Here&#8217;s a snippet of the output you might get back:</p>

<pre><code>--- &amp;id001 !ruby/object:Puppet::Resource::Catalog
  aliases: {}
    applying: false
      classes: []
      ...</code></pre>

<p>Another example to get back the CA Certificate of the puppetmaster doesn&#8217;t require you to be authenticated with your own signed SSL Certificates, since that&#8217;s something you would need before you authenticate.</p>

<pre><code>curl --insecure -H &#39;Accept: s&#39; https://puppetmaster:8140/production/certificate/ca

-----BEGIN CERTIFICATE-----
MIICHTCCAYagAwIBAgIBATANBgkqhkiG9w0BAQUFADAXMRUwEwYDVQQDDAxwdXBw</code></pre>

<h1 id='puppet_master_and_puppet_agent_shared_rest_api_reference'>puppet master and puppet agent shared REST API Reference</h1>

<h3 id='certificate'>Certificate</h3>

<p>GET <code>/certificate/{ca, other}</code></p>

<pre><code>curl -k -H &quot;Accept: s&quot; https://puppetmaster:8140/production/certificate/ca
curl -k -H &quot;Accept: s&quot; https://puppetcleint:8139/production/certificate/puppetclient</code></pre>

<h1 id='puppet_master_rest_api_reference'>puppet master REST API Reference</h1>

<h2 id='authenticated_resources_valid_signed_certificate_required'>Authenticated Resources (valid, signed certificate required)</h2>

<h3 id='catalogs'>Catalogs</h3>

<p>GET <code>/{environment}/catalog/{node certificate name}</code></p>

<pre><code>curl -k -H &quot;Accept: pson&quot; https://puppetmaster:8140/production/catalog/myclient</code></pre>

<h3 id='certificate_revocation_list'>Certificate Revocation List</h3>

<p>GET <code>/certificate_revocation_list/ca</code></p>

<pre><code>curl -k -H &quot;Accept: s&quot; https://puppetmaster:8140/production/certificate/ca</code></pre>

<h3 id='certificate_request'>Certificate Request</h3>

<p>GET <code>/{environment}/certificate_requests/{anything}</code> GET <code>/{environment}/certificate_request/{node certificate name}</code></p>

<pre><code>curl -k -H &quot;Accept: yaml&quot; https://puppetmaster:8140/production/certificate_requests/all
curl -k -H &quot;Accept: yaml&quot; https://puppetmaster:8140/production/certificate_request/puppetclient</code></pre>

<h3 id='reports__submit_a_report'>Reports - Submit a report</h3>

<p>PUT <code>/{environment}/report/{node certificate name}</code></p>

<pre><code>curl -k -X PUT -H &quot;Content-Type: text/yaml&quot; -d &quot;{key:value}&quot; https://puppetclient:8139/production/report/puppetclient</code></pre>

<h3 id='file_server'>File Server</h3>

<p>GET <code>/file{metadata, content, bucket}/{file}</code> File serving is covered in more depth on the <span>wiki</span> (http://projects.puppetlabs.com/projects/puppet/wiki/File_Serving_Configuration)</p>

<h3 id='node__returns_the_facts_for_the_specified_node'>Node - Returns the Facts for the specified node</h3>

<p>GET <code>/{environment}/node/{node certificate name}</code></p>

<pre><code>curl -k -H &quot;Accept: yaml&quot; https://puppetmaster:8140/production/node/puppetclient</code></pre>

<h3 id='status__just_used_for_testing'>Status - Just used for testing</h3>

<p>GET <code>/{environment}/status/{anything}</code></p>

<pre><code>curl -k -H &quot;Accept: pson&quot; https://puppetmaster:8140/production/certificate_request/puppetclient</code></pre>

<h1 id='puppet_agent_rest_api_reference'>puppet agent REST API Reference</h1>

<p>puppet agent is by default set not to listen to HTTP requests. To enable this you must set &#8216;listen = true&#8217; in the puppet.conf or pass &#8217;&#8211;listen true&#8217; to puppet agent when starting. The <a href='./security.html#namespaceauthconf'>namespaceauth</a> file must also exist, and the <a href='./security.html#authconf'>rest_authconfig</a> must allow access to these resources, which isn&#8217;t done by default.</p>

<h3 id='facts'>Facts</h3>

<p>GET <code>/{environment}/facts/{anything}</code></p>

<pre><code>curl -k -H &quot;Accept: yaml&quot; https://puppetclient:8139/production/facts/{anything}</code></pre>

<h3 id='run__cause_the_client_to_update_like_puppetrun_or_puppet_kick'>Run - Cause the client to update like puppetrun or puppet kick</h3>

<p>PUT <code>/{environment}/run/{node certificate name}</code></p>

<pre><code>curl -k -X PUT -H &quot;Content-Type: text/pson&quot; -d &quot;{}&quot; https://puppetclient:8139/production/run/{anything}</code></pre>
            </div>
            <div class="secondary-content">
                    <div id="subCol">
        <h3 class="chapter">Contents</h3>
        <ol class="chapters">
<li><a href="#rest_api">REST API</a></li>
<li><a href="#rest_api_security">REST API Security</a></li>
<li><a href="#testing_the_rest_api_using_curl">Testing the REST API using curl</a></li>
<li><a href="#puppet_master_and_puppet_agent_shared_rest_api_reference">puppet master and puppet agent shared REST API Reference</a></li>
<li>
<a href="#puppet_master_rest_api_reference">puppet master REST API Reference</a><ul style="list-style: none;"><li>
<a href="#authenticated_resources_valid_signed_certificate_required">Authenticated Resources (valid, signed certificate required)</a><ul style="list-style: none;">
<li><a href="#catalogs">Catalogs</a></li>
<li><a href="#certificate_revocation_list">Certificate Revocation List</a></li>
<li><a href="#certificate_request">Certificate Request</a></li>
<li><a href="#reports__submit_a_report">Reports - Submit a report</a></li>
<li><a href="#file_server">File Server</a></li>
<li><a href="#node__returns_the_facts_for_the_specified_node">Node - Returns the Facts for the specified node</a></li>
<li><a href="#status__just_used_for_testing">Status - Just used for testing</a></li>
</ul>
</li></ul>
</li>
<li><a href="#puppet_agent_rest_api_reference">puppet agent REST API Reference</a></li></ol></div>
            </div>
          </div>
        </div>
      </section>

		<footer id="footer">
      <div class="site-width">
        <div class="primary-secondary-content">
          <div class="primary-content">
            <section id="newsletter">
                 <h4>Puppet Labs is Hiring</h4>
                 <p><a href="http://www.puppetlabs.com/company/jobs/">Engineers, developers & consultants</a>
                  <p>  
		<h4>Newsletter</h4>
              <p>Stay up to date on all things puppet</p>
              <form action="http://lfov.net/webrecorder/f" method="post" name="Newsletter" id="footerform">
                <input type="hidden" name="formid" value="3d424fd0-4204-435f-afde-aa1c4a6bc2f1"/>
                <input type="hidden" name="cid" value="LF_c268993e"/>
                <fieldset>
                  <legend>Newsletter</legend>
                  <label form="email">Email</label>
                  <input type="text" name="email" id="email" class="required email" />
                  <button type="submit">Subscribe</button>
                </fieldset>
              </form>

            </section>
            <section id="elsewhere">
              <h4>Get Involved</h4>
              <ul>
                <li class="chat"><a href="http://webchat.freenode.net/?channels=puppet" rel="external"><span class="indicator"></span><span>Chat with us on IRC</span></a></li>
                <li class="discussion"><a href="http://groups.google.com/group/puppet-users?pli=1" rel="external"><span class="indicator"></span><span>Join the Mailing List</span></a></li>
                
                <li class="linkedin"><a href="http://www.linkedin.com/groups?about=&gid=696467&trk=anet_ug_grppro" rel="external"><span class="indicator"></span><span>Join the Puppet Users LinkedIn group</span></a></li>

		

              </ul>
            </section>
          </div>
          <div class="secondary-content">
            <section id="book-it">
              <h4>Get the book!</h4>
              <p>Written by James Turnbull, <a href="http://apress.com/book/view/1590599780" rel="nofollow">Pulling Strings with Puppet</a> is the first book to introduce the powerful Puppet system administration tool. </p>
              <a href="http://apress.com/book/view/1590599780" rel="nofollow"><img src="http://puppetlabs.com/images/book.png" /></a>
            </section>
          </div>
        </div>
      </div>
		</footer>

    <div id="copyright">
      <div class="site-width">
        &copy; <?= date('Y'); ?> <a href="<?php bloginfo('url'); ?>/" title="<?php bloginfo('name'); ?>"><?php bloginfo('name'); ?></a>
        <span class="vcard">
         <span class="org"></span>
         <a class="email" href="mailto:info@puppetlabs.com">info@puppetlabs.com</a>
          <span class="adr">
           <span class="street-address">222 NW Davis Street</span>
           /
           <span class="locality">Portland</span>, 
           <span class="region">OR</span>
           <span class="postal-code">97209</span>

          </span>
         <span class="tel">1-877-575-9775</span>
        </span>          
      </div>
    </div>
    <script src="http://munchkin.marketo.net/munchkin.js" type="text/javascript"></script> <script>mktoMunchkin("307-QLA-991");</script> 
    <!-- BEGIN: LOOPFUSE TRACKING -->
    <script src="http://lfov.net/webrecorder/js/listen.js" type="text/Javascript"></script>
    <script type="text/Javascript">
    _lf_cid = "LF_c268993e";
    _lf_remora();
    </script>
    <!-- END: LOOPFUSE TRACKING -->
    
  	<script type="text/javascript">Cufon.now();</script>
  	<style type="text/css">h1, h2, .btn { visibility : visible; }</style>

	</body>
</html>        
