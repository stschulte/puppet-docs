<!DOCTYPE html>
<html dir="ltr" lang="en-US">
  <head>
  	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  	<title>Documentation | Puppet Labs - exec</title>
  	<meta name="description" content="The open source leader in data center automation">
  	<link rel="alternate" type="text/xml" title="Puppet Labs RSS 0.92 Feed" href="http://puppetlabs.com/feed/rss/">
  	<link rel="alternate" type="application/atom+xml" title="Puppet Labs Atom Feed" href="http://puppetlabs.com/feed/atom/">
  	<link rel="alternate" type="application/rss+xml" title="Puppet Labs RSS 2.0 Feed" href="http://puppetlabs.com/feed/">
  	<link rel="pingback" href="http://puppetlabs.com/xmlrpc.php">
    <link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://puppetlabs.com/xmlrpc.php?rsd" />
    <link rel='index' title='Puppet Labs' href='http://docs.puppetlabs.com' />

<!-- Google stats -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-1537572-5");
pageTracker._setDomainName(".puppetlabs.com");
pageTracker._trackPageview();
} catch(err) {}</script>
<!-- End Google stats -->


    <!-- FIXME: absolute paths -->

    <script type='text/javascript' src='/files/javascripts/html5.js'></script>
    <script type='text/javascript' src='/files/javascripts/jquery-1.3.2.min.js'></script>
    <script type='text/javascript' src='/files/javascripts/drop_down.js'></script>
    <script type='text/javascript' src='/files/javascripts/cufon-yui.js'></script>
    <script type='text/javascript' src='/files/fonts/Klavika_400-Klavika_600.font.js'></script>
    <script type='text/javascript' src='/files/javascripts/ampersands.js'></script>

    <!-- All in One SEO Pack 1.6.10.1 by Michael Torbert of Semper Fi Web Design[127,146] -->
    <meta name="keywords" content="Puppet, puppet labs, reductive labs, open source, system administrator, ruby, data center, automation, support" />
    <link rel="canonical" href="http://docs.puppetlabs.com" />
    <!-- /all in one seo pack -->
	
    <!-- FIXME: absolute paths -->

    <link rel="stylesheet" type="text/css" href="/files/stylesheets/style.css" media="screen"> <!-- index -->

    <!--[if IE 7]>
	  <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_7.css" media="screen"> <!-- index -->
    <![endif]-->
  
    <!--[if IE 8]>
	    <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_8.css" media="screen"> <!-- index -->
    <![endif]-->		

  	<script type="text/javascript">
      Cufon.replace('h1, h2', { fontWeight: '600' });
  	</script>
</head>



        
  <body id="resources" class="docs">
  <style type="text/css">h1, h2{ visibility : hidden }</style>		
  <!--[if IE 8]>
    <style type="text/css">h1, h2{ visibility : visible }</style>
  <![endif]-->		

  	<header id="header">
      <div class="site-width">
    		<h1><a href="http://puppetlabs.com/"><span>Puppet Labs</span></a></h1>
        <a class="screen-reader-content" href="#content">Skip navigation</a>
        <nav>
    		<ul id="global-navigation">
          <li id="puppet-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/puppet/">
              <span>Puppet</span>

              <span class="drop-down-trigger"></span>
            </a>
            <ul>            
              <li>
                <ul>
                  <li class="page_item page-item-757"><a href="http://www.puppetlabs.com/puppet/introduction/" title="Introduction">Introduction</a></li>
<li class="page_item page-item-769"><a href="http://www.puppetlabs.com/puppet/requirements/" title="Requirements">Requirements</a></li>
<li class="page_item page-item-956"><a href="http://www.puppetlabs.com/puppet/solutions/" title="Solutions">Solutions</a></li>
<li class="page_item page-item-1159"><a href="http://www.puppetlabs.com/puppet/users/" title="Users">Users</a></li>

<li class="page_item page-item-2415"><a href="http://www.puppetlabs.com/puppet/what-customers-are-saying/" title="What Customers are Saying">What Customers are Saying</a></li>
                </ul>
              </li>
              <li>
                <ul>
                  <li class="page_item page-item-1977"><a href="http://forge.puppetlabs.com" title="Module Forge">Module Forge</a></li>
<li class="page_item page-item-751"><a href="http://www.puppetlabs.com/puppet/related-projects/dashboard/" title="Dashboard">Dashboard</a></li>
<li class="page_item page-item-753"><a href="http://www.puppetlabs.com/puppet/related-projects/facter/" title="Facter">Facter</a></li>

                </ul>
              </li>
            </ul>
          </li>
          <li id="services-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/services/">
              <span>Services</span>
              <span class="drop-down-trigger"></span>

            </a>
            <ul>
              <li class="page_item page-item-783"><a href="http://www.puppetlabs.com/services/overview/" title="Overview">Overview</a></li>
<li class="page_item page-item-839"><a href="http://www.puppetlabs.com/services/support/" title="Enterprise Support">Enterprise Support</a></li>
<li class="page_item page-item-845"><a href="http://www.puppetlabs.com/services/training-workshops/" title="On-Site Training &amp; Consulting">On-Site Training &amp; Consulting</a></li>
<li class="page_item page-item-849"><a href="/category/events/upcoming/" title="Events &amp; Public Training">Events &amp; Public Training</a></li>

<li class="page_item page-item-2424"><a href="http://www.puppetlabs.com/services/what-customers-are-saying/" title="What Customers are Saying">What Customers are Saying</a></li>
<li class="page_item page-item-851"><a href="http://www.puppetlabs.com/services/partners/" title="Partners">Partners</a></li>
<li class="page_item page-item-1037"><a href="/resources/customer-support" title="Customer Support">Customer Support</a></li>
            </ul>
          </li>
          <li id="resources-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/resources/">
              <span>Resources</span>

              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-1048"><a href="http://www.puppetlabs.com/resources/overview-2/" title="Overview">Overview</a></li>
<li class="page_item page-item-833"><a href="http://www.puppetlabs.com/resources/case-studies/" title="Case Studies">Case Studies</a></li>
<li class="page_item page-item-1052"><a href="http://www.puppetlabs.com/resources/customer-support/" title="Customer Support">Customer Support</a></li>
<li class="page_item page-item-1040"><a href="http://docs.puppetlabs.com" title="Documentation">Documentation</a></li>
<li class="page_item page-item-872"><a href="http://info.puppetlabs.com/register-download" title="Downloads">Downloads</a></li>

<li class="page_item page-item-1961"><a href="http://forge.puppetlabs.com" title="Module Forge">Module Forge</a></li>
<li class="page_item page-item-835"><a href="http://info.puppetlabs.com/request-whitepapers.html" title="White Papers">White Papers</a></li>
<li class="page_item page-item-1967"><a href="http://projects.puppetlabs.com/projects/puppet/wiki" title="Wiki">Wiki</a></li>
            </ul>

          </li>
          <li id="community-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/community/">
              <span>Community</span>

              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-2195"><a href="http://www.puppetlabs.com/community/overview/" title="Overview">Overview</a></li>
<li class="page_item page-item-2264"><a href="http://www.puppetlabs.com/community/puppet-camp/" title="Puppet Camp">Puppet Camp</a></li>
<li class="page_item page-item-2249"><a href="http://www.puppetlabs.com/community/user-groups-and-devops-groups/" title="User Groups &amp; DevOps Groups">User Groups &amp; DevOps Groups</a></li>
<li class="page_item page-item-2215"><a href="http://www.puppetlabs.com/community/presentations/" title="Presentations">Presentations</a></li>

<li class="page_item page-item-2217"><a href="http://www.puppetlabs.com/community/videos/" title="Videos">Videos</a></li>
            </ul>
          </li>

          <li id="company-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/company/">
              <span>Company</span>
              <span class="drop-down-trigger"></span>
            </a>

            <ul>
              <li class="page_item page-item-2316"><a href="http://www.puppetlabs.com/company/overview/" title="Overview">Overview</a></li>
<li class="page_item page-item-2179"><a href="http://www.puppetlabs.com/company/news/" title="News">News</a></li>
<li class="page_item page-item-1571"><a href="http://www.puppetlabs.com/company/jobs/" title="Jobs">Jobs</a></li>
<li class="page_item page-item-2313"><a href="http://www.puppetlabs.com/company/contact-us/" title="Contact Us">Contact Us</a></li>
            </ul>
          </li>
    		</ul>	   
          <div id="misc-navigation">

			  <ul>
				<li><a href="http://docs.puppetlabs.com">Documentation</a></li>
				<li><a href="http://puppetlabs.com/resources/customer-support/">Support</a></li>
				<li><a href="http://puppetlabs.com/company/#contact">Contact Us</a></li>
				<li><a href="http://projects.puppetlabs.com/">Bug Tracker</a></li>
				<li><a href="http://puppetlabs.com/resources/downloads" class="gateway">Download</a></li>
			  </ul>
			<form action="http://www.google.com/cse" id="cse-search-box">

			  <div>
				<input type="hidden" name="cx" value="017884045025332504017:1mnj-dlgfcc" />
				<input type="hidden" name="ie" value="UTF-8" />
				<input type="text" name="q" size="31" />
				<input type="submit" name="sa" class="searchbtn" value="Search" />
			  </div>
			</form>
			<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en"></script>

          </div>
      </nav>
    	</div>
    </header>  

      <section id="masthead">
        <div class="site-width">
          <h1>Docs: <span class="section-name">exec</span></h1>
          <ul id="doc-navigation">
            <li><a href="/">Docs Home</a></li>
            <li class="with-submenu">
              <a href="#">
                <span>Quick Nav</span>
                <span class="drop-down-trigger"></span>
              </a>
               <!-- the following links can't be relative, unfortunately -->
               <!-- future: add some JS to disable this if running from file:// -->
	            <dl>
	              <dt>Guides</dt>
	              <dd><a href="/index.html">Index</a></dd>
                      <dt>Resource Types</dt>
	              <dd><a href="/guides/types/">By Category</a></dd>
	              <dd><a href="/guides/types/alphabetical_index.html">Alphabetical</a></dd>
	              <dt>References</dt>
                      <dd><a href="/references/2.6.1/">2.6.1</a></dd>
                      <dd><a href="/references/2.6.0/">2.6.0</a></dd> 
                      <dd><a href="/references/0.25.5/">0.25.5</a></dd> 
	              <dd><a href="/references/0.24.8/">0.24.8</a></dd>
	              <dd><a href="/references/">Other Versions</a></dd>
	            </dl>
            </li>
            <li><a href="/contribute.html">Contribute</a></li>
          </ul>
        </div>
      </section>
    
      <section id="content">
        <div class="site-width">
          <div class="primary-secondary-content">
            <div class="primary-content">
              <h1 id='exec'>exec</h1>

<p>Executes external commands.</p>
              <h2 id='introduction'>Introduction</h2>

<p>It is critical that all commands executed using this mechanism can be run multiple times without harm, i.e., they are <em>idempotent</em>. One useful way to create idempotent commands is to use the checks like <code>creates</code> to avoid running the command unless some condition is met.</p>

<p>Note also that you can restrict an <code>exec</code> to only run when it receives events by using the <code>refreshonly</code> parameter; this is a useful way to have your configuration respond to events with arbitrary commands.</p>

<p>It is worth noting that <code>exec</code> is special, in that it is not currently considered an error to have multiple <code>exec</code> instances with the same name. This was done purely because it had to be this way in order to get certain functionality, but it complicates things. In particular, you will not be able to use <code>exec</code> instances that share their commands with other instances as a dependency, since Puppet has no way of knowing which instance you mean.</p>

<p>For example:</p>

<pre><code># defined in the production class
exec { &quot;make&quot;:
    cwd =&gt; &quot;/prod/build/dir&quot;,
    path =&gt; &quot;/usr/bin:/usr/sbin:/bin&quot;
}

. etc. .

# defined in the test class
exec { &quot;make&quot;:
    cwd =&gt; &quot;/test/build/dir&quot;,
    path =&gt; &quot;/usr/bin:/usr/sbin:/bin&quot;
}</code></pre>

<p>Any other type would throw an error, complaining that you had the same instance being managed in multiple places, but these are obviously different images, so <code>exec</code> had to be treated specially.</p>

<p>It is recommended to avoid duplicate names whenever possible.</p>

<p>Note that if an <code>exec</code> receives an event from another resource, it will get executed again (or execute the command specified in <code>refresh</code>, if there is one).</p>

<p>There is a strong tendency to use <code>exec</code> to do whatever work Puppet can&#8217;t already do; while this is obviously acceptable (and unavoidable) in the short term, it is highly recommended to migrate work from <code>exec</code> to native Puppet types as quickly as possible. If you find that you are doing a lot of work with <code>exec</code>, please at least notify us at Puppet Labs what you are doing, and hopefully we can work with you to get a native resource type for the work you are doing.</p>

<h2 id='requirements'>Requirements</h2>

<p>No additional requirmements.</p>

<h2 id='platforms'>Platforms</h2>

<p>All platforms.</p>

<h2 id='version_compatibility'>Version Compatibility</h2>
<div class='warning'><p>This section has not been completed.</p></div>
<h2 id='parameters'>Parameters</h2>

<h3 id='id591'><code>command</code></h3>

<p>The actual command to execute. Must either be fully qualified or a search path for the command must be provided. If the command succeeds, any output produced will be logged at the instance&#8217;s normal log level (usually <code>notice</code>), but if the command fails (meaning its return code does not match the specified code) then any output is logged at the <code>err</code> log level.</p>
<div class='info'><p>This is the <code>namevar</code> for this resource type.</p></div>
<h3 id='id592'><code>creates</code></h3>

<p>A file that this command creates. If this parameter is provided, then the command will only be run if the specified file does not exist:</p>

<pre><code>exec { &quot;tar xf /my/tar/file.tar&quot;:
    cwd =&gt; &quot;/var/tmp&quot;,
    creates =&gt; &quot;/var/tmp/myfile&quot;,
    path =&gt; [&quot;/usr/bin&quot;, &quot;/usr/sbin&quot;]
}</code></pre>

<h3 id='id593'><code>cwd</code></h3>

<p>The directory from which to run the command. If this directory does not exist, the command will fail.</p>

<h3 id='id594'><code>env</code></h3>
<div class='warning'><p>This parameter is deprecated. Use &#8216;environment&#8217; instead.</p></div><div class='warning'><p>This section has not been completed.</p></div>
<h3 id='id595'><code>environment</code></h3>

<p>Any additional environment variables you want to set for a command. Note that if you use this to set PATH, it will override the <code>path</code> attribute. Multiple environment variables should be specified as an array.</p>

<h3 id='id596'><code>group</code></h3>

<p>The group to run the command as. This seems to work quite haphazardly on different platforms &#8211; it is a platform issue not a Ruby or Puppet one, since the same variety exists when running commnands as different users in the shell.</p>

<h3 id='id597'><code>logoutput</code></h3>

<p>Whether to log output. Defaults to logging output at the loglevel for the <code>exec</code> resource. Use <em>on_failure</em> to only log the output when the command reports an error. Values are <strong>true</strong>, <em>false</em>, <em>on_failure</em>, and any legal log level. Valid values are <code>true</code>, <code>false</code>, <code>on_failure</code>.</p>

<h3 id='id598'><code>onlyif</code></h3>

<p>If this parameter is set, then this <code>exec</code> will only run if the command returns 0. For example:</p>

<pre><code>exec { &quot;logrotate&quot;:
    path =&gt; &quot;/usr/bin:/usr/sbin:/bin&quot;,
    onlyif =&gt; &quot;test `du /var/log/messages | cut -f1` -gt 100000&quot;
}</code></pre>

<p>This would run <code>logrotate</code> only if that test returned true.</p>

<p>Note that this command follows the same rules as the main command, which is to say that it must be fully qualified if the path is not set.</p>

<p>Also note that onlyif can take an array as its value, eg:</p>

<pre><code>onlyif =&gt; [&quot;test -f /tmp/file1&quot;, &quot;test -f /tmp/file2&quot;]</code></pre>

<p>This will only run the exec if /all/ conditions in the array return true.</p>

<h3 id='id599'><code>path</code></h3>

<p>The search path used for command execution. Commands must be fully qualified if no path is specified. Paths can be specified as an array or as a colon-separated list.</p>

<h3 id='id600'><code>refresh</code></h3>

<p>How to refresh this command. By default, the exec is just called again when it receives an event from another resource, but this parameter allows you to define a different command for refreshing.</p>

<h3 id='id601'><code>refreshonly</code></h3>

<p>The command should only be run as a refresh mechanism for when a dependent object is changed. It only makes sense to use this option when this command depends on some other object; it is useful for triggering an action:</p>

<pre><code># Pull down the main aliases file
file { &quot;/etc/aliases&quot;:
    source =&gt; &quot;puppet://server/module/aliases&quot;
}

# Rebuild the database, but only when the file changes
exec { newaliases:
    path =&gt; [&quot;/usr/bin&quot;, &quot;/usr/sbin&quot;],
    subscribe =&gt; File[&quot;/etc/aliases&quot;],
    refreshonly =&gt; true
}</code></pre>

<p>Note that only <code>subscribe</code> and <code>notify</code> can trigger actions, not <code>require</code>, so it only makes sense to use <code>refreshonly</code> with <code>subscribe</code> or <code>notify</code>. Valid values are <code>true</code>, <code>false</code>.</p>

<h3 id='id602'><code>returns</code></h3>

<p>The expected return code(s). An error will be returned if the executed command returns something else. Defaults to 0. Can be specified as an array of acceptable return codes or a single value.</p>

<h3 id='id603'><code>timeout</code></h3>

<p>The maximum time the command should take. If the command takes longer than the timeout, the command is considered to have failed and will be stopped. Use any negative number to disable the timeout. The time is specified in seconds.</p>

<h3 id='id604'><code>unless</code></h3>

<p>If this parameter is set, then this <code>exec</code> will run unless the command returns 0. For example:</p>

<pre><code>exec { &quot;/bin/echo root &gt;&gt; /usr/lib/cron/cron.allow&quot;:
    path =&gt; &quot;/usr/bin:/usr/sbin:/bin&quot;,
    unless =&gt; &quot;grep root /usr/lib/cron/cron.allow 2&gt;/dev/null&quot;
}</code></pre>

<p>This would add <code>root</code> to the cron.allow file (on Solaris) unless <code>grep</code> determines it&#8217;s already there.</p>

<p>Note that this command follows the same rules as the main command, which is to say that it must be fully qualified if the path is not set.</p>

<h3 id='id605'><code>user</code></h3>

<p>The user to run the command as. Note that if you use this then any error output is not currently captured. This is because of a bug within Ruby. If you are using Puppet to create this user, the exec will automatically require the user, as long as it is specified by name.</p>
            </div>
            <div class="secondary-content">
                    <div id="subCol">
        <h3 class="chapter">Contents</h3>
        <ol class="chapters">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#platforms">Platforms</a></li>
<li><a href="#version_compatibility">Version Compatibility</a></li>
<li>
<a href="#parameters">Parameters</a><ul style="list-style: none;">
<li><a href="#id576"><code>command</code></a></li>
<li><a href="#id577"><code>creates</code></a></li>
<li><a href="#id578"><code>cwd</code></a></li>
<li><a href="#id579"><code>env</code></a></li>
<li><a href="#id580"><code>environment</code></a></li>
<li><a href="#id581"><code>group</code></a></li>
<li><a href="#id582"><code>logoutput</code></a></li>
<li><a href="#id583"><code>onlyif</code></a></li>
<li><a href="#id584"><code>path</code></a></li>
<li><a href="#id585"><code>refresh</code></a></li>
<li><a href="#id586"><code>refreshonly</code></a></li>
<li><a href="#id587"><code>returns</code></a></li>
<li><a href="#id588"><code>timeout</code></a></li>
<li><a href="#id589"><code>unless</code></a></li>
<li><a href="#id590"><code>user</code></a></li>
</ul>
</li></ol></div>
            </div>
          </div>
        </div>
      </section>

		<footer id="footer">
      <div class="site-width">
        <div class="primary-secondary-content">
          <div class="primary-content">
            <section id="newsletter">
                 <h4>Puppet Labs is Hiring</h4>
                 <p><a href="http://www.puppetlabs.com/company/jobs/">Engineers, developers & consultants</a>
                  <p>  
		<h4>Newsletter</h4>
              <p>Stay up to date on all things puppet</p>
              <form action="http://lfov.net/webrecorder/f" method="post" name="Newsletter" id="footerform">
                <input type="hidden" name="formid" value="3d424fd0-4204-435f-afde-aa1c4a6bc2f1"/>
                <input type="hidden" name="cid" value="LF_c268993e"/>
                <fieldset>
                  <legend>Newsletter</legend>
                  <label form="email">Email</label>
                  <input type="text" name="email" id="email" class="required email" />
                  <button type="submit">Subscribe</button>
                </fieldset>
              </form>

            </section>
            <section id="elsewhere">
              <h4>Get Involved</h4>
              <ul>
                <li class="chat"><a href="http://webchat.freenode.net/?channels=puppet" rel="external"><span class="indicator"></span><span>Chat with us on IRC</span></a></li>
                <li class="discussion"><a href="http://groups.google.com/group/puppet-users?pli=1" rel="external"><span class="indicator"></span><span>Join the Mailing List</span></a></li>
                
                <li class="linkedin"><a href="http://www.linkedin.com/groups?about=&gid=696467&trk=anet_ug_grppro" rel="external"><span class="indicator"></span><span>Join the Puppet Users LinkedIn group</span></a></li>

		

              </ul>
            </section>
          </div>
          <div class="secondary-content">
            <section id="book-it">
              <h4>Get the book!</h4>
              <p>Written by James Turnbull, <a href="http://apress.com/book/view/1590599780" rel="nofollow">Pulling Strings with Puppet</a> is the first book to introduce the powerful Puppet system administration tool. </p>
              <a href="http://apress.com/book/view/1590599780" rel="nofollow"><img src="http://puppetlabs.com/images/book.png" /></a>
            </section>
          </div>
        </div>
      </div>
		</footer>

    <div id="copyright">
      <div class="site-width">
        &copy; <?= date('Y'); ?> <a href="<?php bloginfo('url'); ?>/" title="<?php bloginfo('name'); ?>"><?php bloginfo('name'); ?></a>
        <span class="vcard">
         <span class="org"></span>
         <a class="email" href="mailto:info@puppetlabs.com">info@puppetlabs.com</a>
          <span class="adr">
           <span class="street-address">222 NW Davis Street</span>
           /
           <span class="locality">Portland</span>, 
           <span class="region">OR</span>
           <span class="postal-code">97209</span>

          </span>
         <span class="tel">1-877-575-9775</span>
        </span>          
      </div>
    </div>
    <script src="http://munchkin.marketo.net/munchkin.js" type="text/javascript"></script> <script>mktoMunchkin("307-QLA-991");</script> 
    <!-- BEGIN: LOOPFUSE TRACKING -->
    <script src="http://lfov.net/webrecorder/js/listen.js" type="text/Javascript"></script>
    <script type="text/Javascript">
    _lf_cid = "LF_c268993e";
    _lf_remora();
    </script>
    <!-- END: LOOPFUSE TRACKING -->
    
  	<script type="text/javascript">Cufon.now();</script>
  	<style type="text/css">h1, h2, .btn { visibility : visible; }</style>

	</body>
</html>        
