<!DOCTYPE html>
<html dir="ltr" lang="en-US">
  <head>
  	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  	<title>Documentation | Puppet Labs - Configuration Guide</title>
  	<meta name="description" content="The open source leader in data center automation">
  	<link rel="alternate" type="text/xml" title="Puppet Labs RSS 0.92 Feed" href="http://puppetlabs.com/feed/rss/">
  	<link rel="alternate" type="application/atom+xml" title="Puppet Labs Atom Feed" href="http://puppetlabs.com/feed/atom/">
  	<link rel="alternate" type="application/rss+xml" title="Puppet Labs RSS 2.0 Feed" href="http://puppetlabs.com/feed/">
  	<link rel="pingback" href="http://puppetlabs.com/xmlrpc.php">
    <link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://puppetlabs.com/xmlrpc.php?rsd" />
    <link rel='index' title='Puppet Labs' href='http://docs.puppetlabs.com' />

<!-- Google stats -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-1537572-5");
pageTracker._setDomainName(".puppetlabs.com");
pageTracker._trackPageview();
} catch(err) {}</script>
<!-- End Google stats -->


    <!-- FIXME: absolute paths -->

    <script type='text/javascript' src='/files/javascripts/html5.js'></script>
    <script type='text/javascript' src='/files/javascripts/jquery-1.3.2.min.js'></script>
    <script type='text/javascript' src='/files/javascripts/drop_down.js'></script>
    <script type='text/javascript' src='/files/javascripts/cufon-yui.js'></script>
    <script type='text/javascript' src='/files/fonts/Klavika_400-Klavika_600.font.js'></script>
    <script type='text/javascript' src='/files/javascripts/ampersands.js'></script>

    <!-- All in One SEO Pack 1.6.10.1 by Michael Torbert of Semper Fi Web Design[127,146] -->
    <meta name="keywords" content="Puppet, puppet labs, reductive labs, open source, system administrator, ruby, data center, automation, support" />
    <link rel="canonical" href="http://docs.puppetlabs.com" />
    <!-- /all in one seo pack -->
	
    <!-- FIXME: absolute paths -->

    <link rel="stylesheet" type="text/css" href="/files/stylesheets/style.css" media="screen"> <!-- index -->

    <!--[if IE 7]>
	  <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_7.css" media="screen"> <!-- index -->
    <![endif]-->
  
    <!--[if IE 8]>
	    <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_8.css" media="screen"> <!-- index -->
    <![endif]-->		

  	<script type="text/javascript">
      Cufon.replace('h1, h2', { fontWeight: '600' });
  	</script>
</head>



        
  <body id="resources" class="docs">
  <style type="text/css">h1, h2{ visibility : hidden }</style>		
  <!--[if IE 8]>
    <style type="text/css">h1, h2{ visibility : visible }</style>
  <![endif]-->		

  	<header id="header">
      <div class="site-width">
    		<h1><a href="http://puppetlabs.com/"><span>Puppet Labs</span></a></h1>
        <a class="screen-reader-content" href="#content">Skip navigation</a>
        <nav>
      		<ul id="global-navigation">
            <li id="puppet-tab" class="with-submenu">

              <a href="http://puppetlabs.com/puppet/">
                <span>Puppet</span>
                <span class="drop-down-trigger"></span>
              </a>
              <ul>            
                <li>
                  <ul>
                    <li class="page_item page-item-757"><a href="http://puppetlabs.com/puppet/introduction/" title="Introduction">Introduction</a></li>
                    <li class="page_item page-item-769"><a href="http://puppetlabs.com/puppet/requirements/" title="Requirements">Requirements</a></li>
                    <li class="page_item page-item-828"><a href="http://puppetlabs.com/puppet/features/" title="Features">Features</a></li>
                    <li class="page_item page-item-956"><a href="http://puppetlabs.com/puppet/solutions/" title="Solutions">Solutions</a></li>
                    <li class="page_item page-item-1159"><a href="http://puppetlabs.com/puppet/users/" title="Users">Users</a></li>
                    <li class="page_item page-item-1074"><a href="http://puppetlabs.com/resources/white-papers" title="White Papers">White Papers</a></li>
                    <li class="page_item page-item-1495"><a href="http://puppetlabs.com/resources/case-studies" title="Case Studies">Case Studies</a></li>
                    <li class="page_item page-item-1044"><a href="http://puppetlabs.com/resources/downloads" title="Downloads">Downloads</a></li>
                  </ul>
                </li>
                <li>
                  <ul>
                    <li class="page_item page-item-751"><a href="http://puppetlabs.com/puppet/related-projects/dashboard/" title="Dashboard">Dashboard</a></li>
                    <li class="page_item page-item-753"><a href="http://puppetlabs.com/puppet/related-projects/facter/" title="Facter">Facter</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li id="services-tab" class="with-submenu">
              <a href="http://puppetlabs.com/services/">
                <span>Services</span>
                <span class="drop-down-trigger"></span>
              </a>
              <ul>
                <li class="page_item page-item-783"><a href="http://puppetlabs.com/services/overview/" title="Overview">Overview</a></li>
                <li class="page_item page-item-839"><a href="http://puppetlabs.com/services/support/" title="Enterprise Support">Enterprise Support</a></li>
                <li class="page_item page-item-845"><a href="http://puppetlabs.com/services/training-workshops/" title="On-Site Training &amp; Consulting">On-Site Training &amp; Consulting</a></li>
                <li class="page_item page-item-849"><a href="http://puppetlabs.com/category/events/upcoming/" title="Events &amp; Public Training">Events &amp; Public Training</a></li>
                <li class="page_item page-item-851"><a href="http://puppetlabs.com/services/partners/" title="Partners">Partners</a></li>
                <li class="page_item page-item-1037"><a href="http://puppetlabs.com/resources/customer-support" title="Customer Support">Customer Support</a></li>
              </ul>
            </li>
            <li id="resources-tab" class="with-submenu">
              <a href="http://puppetlabs.com/resources/">
                <span>Resources</span>
                <span class="drop-down-trigger"></span>
              </a>
              <ul>
                <li class="page_item page-item-1048"><a href="http://puppetlabs.com/resources/overview-2/" title="Overview">Overview</a></li>
                <li class="page_item page-item-1040"><a href="http://docs.puppetlabs.com" title="Documentation">Documentation</a></li>
                <li class="page_item page-item-872"><a href="http://puppetlabs.com/resources/downloads/" title="Downloads">Downloads</a></li>
                <li class="page_item page-item-835"><a href="http://puppetlabs.com/resources/white-papers/" title="White Papers">White Papers</a></li>
                <li class="page_item page-item-833"><a href="http://puppetlabs.com/resources/case-studies/" title="Case Studies">Case Studies</a></li>
                <li class="page_item page-item-1052"><a href="http://puppetlabs.com/resources/customer-support/" title="Customer Support">Customer Support</a></li>
              </ul>

            </li>
            <li id="community-tab">
              <a href="http://puppetlabs.com/community/">
                <span>Community</span>
              </a>
            </li>

            <li id="company-tab" class="with-submenu">
              <a href="http://puppetlabs.com/company/">
                <span>Company</span>
                <span class="drop-down-trigger"></span>
              </a>
              <ul>
                <li><a href="http://puppetlabs.com/company/">About Us</a></li>
                <li><a href="http://puppetlabs.com/company/#contact">Contact Us</a></li>
              </ul>
            </li>
      		</ul>	   
          <div id="misc-navigation">
			<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en"></script>
			  <ul>
				<li><a href="http://docs.puppetlabs.com">Documentation</a></li>
				<li><a href="http://puppetlabs.com/resources/customer-support/">Support</a></li>
				<li><a href="http://puppetlabs.com/company/#contact">Contact Us</a></li>
				<li><a href="http://puppetlabs.com/resources/downloads" class="gateway">Download</a></li>
			  </ul>
			<form action="http://www.google.com/cse" id="cse-search-box">
			  <div>
				<input type="hidden" name="cx" value="017884045025332504017:1mnj-dlgfcc" />
				<input type="hidden" name="ie" value="UTF-8" />
				<input type="text" name="q" size="31" />
				<input type="submit" name="sa" class="searchbtn" value="Search" />
			  </div>
			</form>
			<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en"></script>
		  </div>
        </nav>
    	</div>
    </header>  

      <section id="masthead">
        <div class="site-width">
          <h1>Docs: <span class="section-name">Configuration Guide</span></h1>
          <ul id="doc-navigation">
            <li><a href="/">Docs Home</a></li>
            <li class="with-submenu">
              <a href="#">
                <span>Quick Nav</span>
                <span class="drop-down-trigger"></span>
              </a>
               <!-- the following links can't be relative, unfortunately -->
               <!-- future: add some JS to disable this if running from file:// -->
	            <dl>
	              <dt>Guides</dt>
	              <dd><a href="/index.html">Index</a></dd>
                      <dt>Resource Types</dt>
	              <dd><a href="/guides/types/">By Category</a></dd>
	              <dd><a href="/guides/types/alphabetical_index.html">Alphabetical</a></dd>
	              <dt>References</dt>
                      <dd><a href="/references/2.6.1/">2.6.1</a></dd>
                      <dd><a href="/references/2.6.0/">2.6.0</a></dd> 
                      <dd><a href="/references/0.25.5/">0.25.5</a></dd> 
	              <dd><a href="/references/0.24.8/">0.24.8</a></dd>
	              <dd><a href="/references/">Other Versions</a></dd>
	            </dl>
            </li>
            <li><a href="/contribute.html">Contribute</a></li>
          </ul>
        </div>
      </section>
    
      <section id="content">
        <div class="site-width">
          <div class="primary-secondary-content">
            <div class="primary-content">
              <h1 id='configuration_guide'>Configuration Guide</h1>

<p>Once Puppet is installed, learn how to set it up for initial operation.</p>
              <h2 id='open_firewall_ports_on_server_and_client'>Open Firewall Ports On Server and Client</h2>

<p>In order for the puppet server to centrally manage clients, you may need to open port 8140, both TCP and UDP, on the server and client machines.</p>

<h2 id='configuration_files'>Configuration Files</h2>

<p>The main configuration file for Puppet is <code>/etc/puppet/puppet.conf</code>. A package based installation file will have created this file automatically. Unlisted settings have reasonable defaults. To see all the possible values, you may run:</p>

<pre><code>$ puppet --genconfig   </code></pre>

<h2 id='configure_dns'>Configure DNS</h2>

<p>The puppet client looks for a server named <code>puppet</code>. If you have local DNS zone files, you may want to add a CNAME record pointing to the server machine in the appropriate zone file.</p>

<pre><code>puppet   IN   CNAME  crabcake.picnic.edu.</code></pre>

<p>By setting up the CNAME you will avoid having to specify the server name in the configuration of each client.</p>

<p>See the book &#8220;DNS and Bind&#8221; by Cricket Liu et al if you need help with CNAME records. After adding the CNAME record, restart your name server. You can also add a host entry in the <code>/etc/hosts</code> file on both the server and client machines.</p>

<p>For the server:</p>

<pre><code>127.0.0.1 localhost.localdomain localhost puppet</code></pre>

<p>For the clients:</p>

<pre><code>192.168.1.67 crabcake.picnic.edu crabcake puppet</code></pre>
<div class='warning'><p>If you can ping the server by the name <code>puppet</code> but Syslog (for example <code>/var/log/messages</code>) on the clients still has entries stating the puppet client cannot connect to the server, verify port 8140 is open on the server.</p></div>
<h2 id='puppet_language_setup'>Puppet Language Setup</h2>

<h3 id='create_your_site_manifest'>Create Your Site Manifest</h3>

<p>Puppet is a declarative system, so it does not make much sense to speak of &#8220;executing&#8221; Puppet programs or scripts. Instead, we choose to use the word <em>manifest</em> to describe our Puppet code, and we speak of <em>applying</em> those manifests to the managed systems. Thus, a <em>manifest</em> is a text document written in the Puppet language and meant to describe and result in a desired configuration.</p>

<p>Puppet assumes that you will have one central manifest capable of configuring an entire site, which we call the <em>site manifest</em>. You could have multiple, separate site manifests if you wanted, though if doing this each of them would need their own puppet servers. Individual system differences can be seperated out, node by node, in the site manifest.</p>

<p>Puppet will start with <code>/etc/puppet/manifests/site.pp</code> as the primary manifest, so create <code>/etc/puppet/manifests</code> and add your manifest, along with any files it includes, to that directory. It is highly recommended that you use some form of version control (git, svn, etc) to keep track of changes to manifests.</p>

<h3 id='example_manifest'>Example Manifest</h3>

<p>The site manifest can do as little or as much as you want. A good starting point is a manifest that makes sure that your sudoers file has the appropriate permissions:</p>

<pre><code># site.pp
file { &quot;/etc/sudoers&quot;:
    owner =&gt; root, group =&gt; root, mode =&gt; 440
}</code></pre>

<p>For more information on how to create the site manifest, see the tutorials listed in the <a href='../index.html#getting_started'>Getting Started</a> section.</p>

<h2 id='start_the_central_daemon'>Start the Central Daemon</h2>

<p>Most sites should only need one central puppet server. Puppet Labs will be publishing a document describing best practices for scale-out and failover, though there are various ways to address handling in larger infrastructures. For now, we&#8217;ll explain how to work with the one server, and others can be added as needed.</p>

<p>First, decide which machine will be the central server; this is where puppetmasterd will be run.</p>

<p>The best way to start any daemon is using the local server&#8217;s service management system, often in the form of init scripts.</p>

<p>If you&#8217;re running on Red Hat, CentOS, Fedora, Debian, Ubuntu, or Solaris, the OS package already contains a suitable init script. If you don&#8217;t have one, you can either create your own using an existing init script as an example, or simply run without one (though this is not advisable for production environments).</p>

<p>It is also neccessary to create the puppet user and group that the daemon will use. Either create these manually, or start the daemon with the <code>--mkusers</code> flag to create them.</p>

<pre><code class='sh' lang='sh'># /usr/sbin/puppetmasterd --mkusers</code></pre>

<p>Starting the puppet daemon will automatically create all necessary certificates, directories, and files.</p>
<div class='note'><p>To enable the daemon to also function as a file server, so that clients can copy files from it, create a <a href='./file_serving.html'>fileserver configuration file</a> and restart pupetmasterd.</p></div>
<h2 id='verifying_installation'>Verifying Installation</h2>

<p>To verify that your daemon is working as expected, pick a single client to use as a testbed. Once Puppet is installed on that machine, run a single client against the central server to verify that everything is working appropriately. You should start the first client in verbose mode, with the <code>--waitforcert</code> flag enabled:</p>

<pre><code class='sh' lang='sh'># puppetd --server myserver.domain.com --waitforcert 60 --test</code></pre>

<p>Adding the <code>--test</code> flag causes puppetd to stay in the foreground, print extra output, only run once and then exit, and to just exit if the remote configuration fails to compile (by default, puppetd will use a cached configuration if there is a problem with the remote manifests).</p>

<p>In running the client, you should see the message:</p>

<pre><code>info: Requesting certificate
warning: peer certificate won&#39;t be verified in this SSL session
notice: Did not receive certificate</code></pre>
<div class='info'><p>This message will repeat every 60 seconds with the above command.</p></div>
<p>This is normal, since your server is not auto-signing certificates as a security precaution.</p>

<p>On your server, list the waiting certificates:</p>

<pre><code class='sh' lang='sh'># puppetca --list</code></pre>

<p>You should see the name of the test client. Now go ahead and sign the certificate:</p>

<pre><code class='sh' lang='sh'># puppetca --sign mytestclient.domain.com</code></pre>

<p>Within 60 seconds, your test client should receive its certificate from the server, receive its configuration, apply it locally, and exit normally.</p>
<div class='note'><p>By default, puppetd runs with a waitforcert of five minutes; set the value to 0 to disable this wait-polling period entirely.</p></div>
<h2 id='scaling_your_installation'>Scaling your Installation</h2>

<p>For more about how to tune Puppet for large environments, see <a href='./scaling.html'>Scaling Puppet</a>.</p>
            </div>
            <div class="secondary-content">
                    <div id="subCol">
        <h3 class="chapter">Contents</h3>
        <ol class="chapters">
<li><a href="#open_firewall_ports_on_server_and_client">Open Firewall Ports On Server and Client</a></li>
<li><a href="#configuration_files">Configuration Files</a></li>
<li><a href="#configure_dns">Configure DNS</a></li>
<li>
<a href="#puppet_language_setup">Puppet Language Setup</a><ul style="list-style: none;">
<li><a href="#create_your_site_manifest">Create Your Site Manifest</a></li>
<li><a href="#example_manifest">Example Manifest</a></li>
</ul>
</li>
<li><a href="#start_the_central_daemon">Start the Central Daemon</a></li>
<li><a href="#verifying_installation">Verifying Installation</a></li>
<li><a href="#scaling_your_installation">Scaling your Installation</a></li></ol></div>
            </div>
          </div>
        </div>
      </section>

		<footer id="footer">
      <div class="site-width">
        <div class="primary-secondary-content">
          <div class="primary-content">
            <section id="newsletter">
                 <h4>Puppet Labs is Hiring</h4>
                 <p><a href="http://www.puppetlabs.com/company/jobs/">Engineers, developers & consultants</a>
                  <p>  
		<h4>Newsletter</h4>
              <p>Stay up to date on all things puppet</p>
              <form action="http://lfov.net/webrecorder/f" method="post" name="Newsletter" id="footerform">
                <input type="hidden" name="formid" value="3d424fd0-4204-435f-afde-aa1c4a6bc2f1"/>
                <input type="hidden" name="cid" value="LF_c268993e"/>
                <fieldset>
                  <legend>Newsletter</legend>
                  <label form="email">Email</label>
                  <input type="text" name="email" id="email" class="required email" />
                  <button type="submit">Subscribe</button>
                </fieldset>
              </form>

            </section>
            <section id="elsewhere">
              <h4>Get Involved</h4>
              <ul>
                <li class="chat"><a href="http://webchat.freenode.net/?channels=puppet" rel="external"><span class="indicator"></span><span>Chat with us on IRC</span></a></li>
                <li class="discussion"><a href="http://groups.google.com/group/puppet-users?pli=1" rel="external"><span class="indicator"></span><span>Join the Mailing List</span></a></li>
                
                <li class="linkedin"><a href="http://www.linkedin.com/groups?about=&gid=696467&trk=anet_ug_grppro" rel="external"><span class="indicator"></span><span>Join the Puppet Users LinkedIn group</span></a></li>

		

              </ul>
            </section>
          </div>
          <div class="secondary-content">
            <section id="book-it">
              <h4>Get the book!</h4>
              <p>Written by James Turnbull, <a href="http://apress.com/book/view/1590599780" rel="nofollow">Pulling Strings with Puppet</a> is the first book to introduce the powerful Puppet system administration tool. </p>
              <a href="http://apress.com/book/view/1590599780" rel="nofollow"><img src="http://puppetlabs.com/images/book.png" /></a>
            </section>
          </div>
        </div>
      </div>
		</footer>

    <div id="copyright">
      <div class="site-width">
        &copy; <?= date('Y'); ?> <a href="<?php bloginfo('url'); ?>/" title="<?php bloginfo('name'); ?>"><?php bloginfo('name'); ?></a>
        <span class="vcard">
         <span class="org"></span>
         <a class="email" href="mailto:info@puppetlabs.com">info@puppetlabs.com</a>
          <span class="adr">
           <span class="street-address">222 NW Davis Street</span>
           /
           <span class="locality">Portland</span>, 
           <span class="region">OR</span>
           <span class="postal-code">97209</span>

          </span>
         <span class="tel">1-877-575-9775</span>
        </span>          
      </div>
    </div>
    <script src="http://munchkin.marketo.net/munchkin.js" type="text/javascript"></script> <script>mktoMunchkin("307-QLA-991");</script> 
    <!-- BEGIN: LOOPFUSE TRACKING -->
    <script src="http://lfov.net/webrecorder/js/listen.js" type="text/Javascript"></script>
    <script type="text/Javascript">
    _lf_cid = "LF_c268993e";
    _lf_remora();
    </script>
    <!-- END: LOOPFUSE TRACKING -->
    
  	<script type="text/javascript">Cufon.now();</script>
  	<style type="text/css">h1, h2, .btn { visibility : visible; }</style>

	</body>
</html>        
